

<form
  class="feedback-card"
  [formGroup]="feedbackForm"
  (ngSubmit)="submit()"
  novalidate
>
  <h2 class="title">Quiz Feedback</h2>

  <!-- Grid container for fields -->
  <div class="form-grid">

    <!-- Quiz ID -->
    <div class="field">
      <label class="label" for="quizId">Quiz ID</label>
      <input
        id="quizId"
        type="number"
        formControlName="quizId"
        class="input"
        placeholder="Enter Quiz ID"
        inputmode="numeric"
      />
      <div class="hint" *ngIf="feedbackForm.get('quizId')?.invalid && feedbackForm.get('quizId')?.touched">
        Quiz ID is required
      </div>
    </div>

    <!-- Participant ID -->
    <div class="field">
      <label class="label" for="participantId">Participant ID</label>
      <input
        id="participantId"
        type="number"
        formControlName="participantId"
        class="input"
        placeholder="Enter Participant ID"
        inputmode="numeric"
      />
      <div class="hint" *ngIf="feedbackForm.get('participantId')?.invalid && feedbackForm.get('participantId')?.touched">
        Participant ID is required
      </div>
    </div>

    <!-- Rating (Stars) -->
    <div class="field">
      <label class="label">Rating</label>

      <div class="rating-row" role="radiogroup" aria-label="Star rating">
        <ng-container *ngFor="let s of [1,2,3,4,5]">
          <button
            type="button"
            class="star"
            [class.filled]="(feedbackForm.value?.rating || 0) >= s"
            (click)="feedbackForm.patchValue({ rating: s })"
            [attr.aria-pressed]="(feedbackForm.value?.rating || 0) === s"
            [attr.aria-label]="s + ' star'"
            title="{{ s }} star"
          >
            â˜…
          </button>
        </ng-container>

        <span class="rating-value">
          {{ feedbackForm.value?.rating || 0 }}/5
        </span>
      </div>
      <!-- Keep rating in the form; no extra inputs needed -->
    </div>

    <!-- Quick Words (chips) -->
    <div class="field">
      <label class="label">Quick Words</label>

      <div class="chips" role="listbox" aria-label="Quick words">
        <button
          type="button"
          class="chip"
          *ngFor="let word of commentWords"
          [class.active]="selectedWords.includes(word)"
          (click)="toggleWord(word)"
          role="option"
          [attr.aria-selected]="selectedWords.includes(word)"
        >
          {{ word }}
        </button>

        <button type="button" class="chip clear" (click)="clearWords()">
          Clear Words
        </button>
      </div>
    </div>

    <!-- Comments (optional)
    <div class="field">
      <label class="label" for="comments">Comments (optional)</label>
      <textarea
        id="comments"
        rows="3"
        formControlName="comments"
        class="textarea"
        placeholder="Add any additional comments..."
      ></textarea>
    </div> -->

    <!-- Emoji (no textbox, only emoji buttons) -->
    <div class="field">
      <label class="label">Emoji</label>

      <div class="emoji-row" aria-label="Emoji reaction options">
        <button
          type="button"
          class="emoji"
          *ngFor="let e of emojiList; let idx = index"
          [class.selected]="feedbackForm.value?.emojiReaction === e"
          (click)="selectEmoji(e)"
          [attr.aria-label]="
            idx === 0 ? 'very happy' :
            idx === 1 ? 'happy' :
            idx === 2 ? 'neutral' :
            idx === 3 ? 'sad' : 'very sad'
          "
          [title]="
            idx === 0 ? 'Very Happy' :
            idx === 1 ? 'Happy' :
            idx === 2 ? 'Neutral' :
            idx === 3 ? 'Sad' : 'Very Sad'
          "
        >
          {{ e }}
          <span class="emoji-caption">
            {{
              idx === 0 ? 'Very Happy' :
              idx === 1 ? 'Happy' :
              idx === 2 ? 'Neutral' :
              idx === 3 ? 'Sad' : 'Very Sad'
            }}
          </span>
        </button>

        <!-- Keep the form value bound without showing a text box -->
        <input type="hidden" formControlName="emojiReaction" />
      </div>
    </div>
  </div>

  <!-- Actions -->
  <div class="actions">
    <button class="btn-primary" type="submit">
      Submit Feedback
    </button>
  </div>
</form>